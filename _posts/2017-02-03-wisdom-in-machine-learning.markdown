---
layout:     post
title:      "聊聊机器学习中的人生智慧"
subtitle:   " \"wisdom in machine learning\""
date:       2017-02-03 20:13:00
author:     "余超群"
header-img: "img/post-bg-os-metro.jpg"
catalog: true
tags:
    - ML
    - "机器学习"
---
机器学习中的人生智慧
---
在学习机器学习的过程中，我曾不止一次地惊呼：“真是赚到了”！单是从中学到的人生智慧，就已经觉得所得匪浅。
以下是我的几点感悟。

###概率视角  
机器能够理解什么? 只有数字。从机器的视角观察这个世界，我们会发现“**一切事件的本质皆是概率**”。  
####1.一切皆是概率
>小到彩票是否中奖，  
明天是否下雨，  
集五福是否值得，  
或是打麻将应采取什么策略，  
大到人生选择，  
高考会不会中榜，  
会跟谁结婚，  
该不该买房，  
会不会出任CEO，迎娶白富美，登上人生巅峰，  
这一切都是概率事件。  
  
当你计算过中彩票的概率和期望，自然不会把成为人生赢家的胜算都压在上面。当你发现集齐五福的人数已经超过两千万，大家一起瓜分两个亿，期望不到10块钱时，那又何必那么费劲，群里抢个红包都比这个大。  
当有人看到北大的毕业生卖猪肉的新闻说：读书也没什么用。你也会有清晰的判断，读书只是增加你成功概率而已，北大毕业总体比普通学校毕业成功的概率更高。真正要做的不是去否定读书的价值，而是去思考如何提高自身的成功概率。当你认识到人生的际遇其实都是概率事件时，在低谷时也就不会自怨自艾，努力没有回报也不会灰心丧气，只会努力把自己准备得更好。  
**人生本来就是一个个概率事件嘛**。  
看待问题的视角转变之后，所有一切都不再是困扰，也不会有抱怨。如果我们把成功的目标变成不断增加自己的成功概率，那唯一的策略就是不断成长。这其实也是AlphaGo强大的原因，因为AlphaGo下每一步棋时，关注就是这步棋是否能使自己的胜率最大。  
####2.主观概率
概率论带给我的第二个思考是：**概率的量化表达可以帮助我们更清晰准确地分析问题**。
以前的经典天气预报就是：明天阴有时有阵雨，局部地区大到暴雨。一堆不确定性累加在一起，让人无法决策，这个信息也就失去了参考价值。现在的天气预报更多的用降水概率等量化指标来描述，于是更精确，更容易理解。这是概率事件，出现小概率事件也是有可能的，而不能说天气预报错了是吧。这也许也是气象预报部门的智慧。
那我们对于任何事情发生的相信程度也可以用主观概率来表达。
> 主观概率：如果用一个数字形式的概率来表示自己对某事的确认程度，所用的就是主观概率。  

罗胖（罗辑思维罗振宇）曾做过一期节目，驳斥中医的科学性。后来他在一期节目中表示，他相信中医的主观概率是5%。也就是说，如果得了不治之症，他还是愿意尝试一下的。  
而我对于中医的主观概率或许是85%。因为我觉得中医不在科学的边界之内，而不能说其不科学。（科学的边界是**可以证伪**，任何不可证伪的理论都不属于科学，比如上帝是否存在的论断。）而我是实用主义者，以我的人生经验，我会把相信中医的主观概率设定得比较高。  
有了主观概率，跟人讨论也会更加容易，而不至于使用“可能”，“可能性更大”，“极不可能”，“可能不”，“不可能”，“肯定”这些模糊的字眼。

####3.贝叶斯学派  
想到要讨论贝叶斯，其实我是拒绝的，有人甚至花一整本书的篇幅来讲这个话题，而我要如何在这么一篇粗浅的文章中写明白。
先抛出一个问题吧：
>有一个硬币，连续抛了32次，出现了32次正面。那抛第33次，你会预测出现哪一面？概率又是多大？（假设每一次抛硬币都是独立事件）  

不同的视角有不同的看法，这里会出现**频率学派**和**贝叶斯学派**颇为不同的观点。  
频率学派认为抛硬币出现正面的概率是固定的，那么不管是第一次还是第33次，出现正面的概率都是一样的，这个概率可能就是50%。但如果我们不知道这个概率，那频率学派就有点无能为力了。  
而贝叶斯学派则认为，抛硬币出现正面的概率本身是一个概率分布。我们事先不知道硬币的概率，但是我们可以假定其出现正面的概率是50%，然后我们根据观测结果不断修正这个概率。当抛硬币这个独立事件出现32次正面0次反面，那我们完全有理由推断这枚硬币并不是均匀的（或是被做过手脚）。  
如果我们使用极大似然估计来估计出现正面的概率：  
$$ P(Y=c_k)=\frac{\sum_{i=1}^{N}I(y_i=c_k)}{N} $$   
那么出现正面的概率等于1，以此预测第33次仍是出现正面。
另有贝叶斯估计：
$$  
P(Y=c_k)=\frac{\sum_{i=1}^{N}I(y_i=c_k)+\lambda}{N+\lambda K}
$$  
其中N是总样本数，K是Y的类别数，比如抛硬币的问题K=2。
贝叶斯估计为了修正最大似然估计可能出现0概率的问题，增加了λ这个参数。常取λ=1，此时称为拉普拉斯平滑。  
$$
P(Y=正面)=\frac{\sum_{i=1}^{N}I(y_i=正面)+1}{N+K}=\frac{32+1}{32+2}=0.97
$$  
 
如此看来，贝叶斯估计不至于极端地认为出现正面的概率为1，而是根据实际观测结果来给出0.97的概率。  
贝叶斯学派在实际应用中的价值在于，现实生活中的概率事件，我们无法确知其概率，那贝叶斯利用观察到的结果来估计就显得意义重大了。当我们有足够的观测数据，贝叶斯估计得到的概率也就接近于实际数值了。  
其实贝叶斯定理本身这个公式是非常简单：
$$
P(A|B)=\frac{P(B|A)P(A)}{P(B)}
$$  
其中P(B)可以用全概率公式计算：  
$$
P(B)=\sum_{A}^{}P(B|A)P(A)
$$  
$$
P(Y=c_j|X=x_k)=\frac{P(X=x_k|Y=c_j)P(Y=c_j)}{\sum_{i=1}^{K}P(X=x_i|Y=c_j)P(Y=c_j)}
$$   
![](https://github.com/yuchaoqun920/nbin30s/raw/master/3/bayes_equation.jpg)
但是想把贝叶斯讲清楚，却非常不易，于是我也就只能写到这个程度了。贝叶斯真的是一个太强大的工具，在垃圾邮件识别和自然语言处理领域强大得无以伦比，甚至语音识别中的隐马尔科夫模型（HMM）也是一个层级贝叶斯模型。感兴趣可以阅读专门讲解贝叶斯的文章，请见文末的参考链接。


###模型和神经网络
从机器的视角看，世间万物都是模型。  
>所谓模型，就是给一定的输入，生成一定的输出。  
传统的模型给定固定输入，输出是一定的，比如逻辑门电路，比如手机的UI，比如计算机。但是人这个模型，你给定一样的输入，没准输出完全不同甚至相反。因为这个模型是概率模型，并不绝对。
神经网络很大一部分参照人类大脑的基本原理来工作，到后来又有了深度神经网络，再到后来每个神经元有一定的机率dropout，给定相同的输入没准有不同的结果，于是跟人类大脑的工作模式越来越像。
理解了神经网络的工作原理，我们去理解一个小孩从出生到长大成人的过程，是不是就容易多了。新生的婴儿跟一张白纸一样，当然有先天的遗传和性格。然后在环境中不断塑造，慢慢变成了后来的样子。当TA在学步，就是神经网络慢慢建立连接并不断强化的过程。婴儿在快速成长之后，有一个神经元连接变少的过程，这其实跟决策树的剪枝原理差不多，过于复杂的连接容易过拟合，而不具备通用性。于是生物就自然演化具备这个过程。想想也是蛮神奇的。  
当你明白了所有这些。你会发现你就是独特的你，永远不可复制，因为你是你的遗传基因在后天这个独一无二的环境中成长起来的。人类的大脑是慢慢学习使得神经元产生连接，这连接想要直接复制，估计难度那叫一个大。所以期望复制大脑实现永生，就不要抱太大希望。就算能完整复制，这个复制的人，没有经历过你所经历的一切，当TA醒来的一瞬间跟你看到的就不一样，ta其实是另外一个人，而不是你。记得《生死课》里比较认同的一个观点：“我”这个个体，是在连续的时间和空间中存在的。不管是空间还是时间只要有一个不是连续的，那就无法再定义成“我”了。所以这种方式的永生只是神话。
所以另外的一个启示，如何让小孩长成你设想的样子，给TA塑造一个环境，给TA“正确”的反馈，包括以身作则，用实际行动给TA足够的输入，慢慢就会养成你想要的样子。
女朋友也一样，你要足够积极的反馈，她才会越来越温柔，当然对于女朋友这种太过复杂的模型，我不敢保证，训练模型的过程中请千万注意人身安全。  

对于我们自己的成长，我们要用足够的实践去训练自己的模型变得更加强大。甚至学习过程也可以套用机器学习的思路：**给定一个优化目标，在实践中积累经验不断优化这个目标。**  
>第一目标必须清晰准确容易衡量；  
第二要通过实践积累经验；  
第三要利用经验中的反馈不断优化目标；  

三者缺一不可，当你在实践，但只是重复劳动，并没有去优化目标，那自然是不会有进步的。于是此处可以再次强调**刻意练习**的力量。

###集成方法—三个臭皮匠顶个诸葛亮  

一个多好的模型是具有价值的。一定要99%的成功率吗？
并不一定，集成的思路就是找一堆臭皮匠，大家一起出谋划策。没准也能达到很好的效果。
我们举个例子，每个臭皮匠预测明天是否下雨的准确率是0.6。那当我们找了100个独立的臭皮匠来，然后大家投票，少数服从多数。你会惊人地发现，准确率提升到了0.97以上，如果你想继续提升，找更多的臭皮匠呗。  
下图是臭皮匠个数和准确率的关系曲线：  
![集成方法——0.6](https://github.com/yuchaoqun920/nbin30s/raw/master/3/ensemble_0.6.png)  
于是我们得到一个结论：  
> 如果你可以找到一个还过得去的解决方案，你就可以找到一个接近完美的解决方案。 
 
当然这个过得去的解决方案必须比随机猜测强一些，准确率大于50%，不然还不如随机猜测是吧。  

这个理论太强大了。我们拓展一下。
>你在股市里，如果可以长期稳定保持在50%以上的成功率（可能至少是52%或者更高，因为要承担交易费用等潜在损失），就足够你赚钱了，而且是赚到没朋友。  

所以有人推崇高频交易，可以通过多次重复，实现复利的指数级增长。  
如此看来，股市赚钱好像很容易，而大多数人的成功率都很难超过50%。即使是50%的成功率，第一次赚10%，第二次亏10%，实际只剩99%，不断重复下去也会亏得只剩下内裤。而此时的计算并没有算上交易费用。股市中还有各种内幕交易甚至操纵股价，如此随机猜测的成功率都到不了50%，长期下去哪有不亏钱的。这就相当于网络游戏中的普通玩家，而别人是人民币玩家，只有被虐的份了。  
今后，越来越多的机器智能参与到股市的博弈中，他们成功率必然大于50%（必然能够赚钱才会投放市场），还可以通过集成的方法把胜率提升到99%以上。相对而言你的成功率又降低了，因为波动的市场本质是**零和博弈**，考虑到抽水就是负和博弈。人在这个领域与机器智能竞争，就像拿着大刀长矛跟火枪对决，不自量力了。当然这是对未来的预测，而在大多数交易者都是散户的当下，或许还是存在各种机会的。

###高维度打击
感知机是神经网络的基础单元，一个线性分类器。抽象理解就是在一个二维空间中画一条直线，将正例和负例分开。对于异或问题，你会发现，你无法画一条直线来直接得到正确的结果。感知机刚出现时，就是因为无法解决异或问题，沉寂了很久。后来出现了多层的感知机也就是神经网络或者深度学习。这时就可以把二维平面的异或问题映射到三维，这个时候你就可以用一个平面将其分类。我们称其为分割超平面。直线和平面的本质都是分割超平面，二维空间的超平面是直线，三维空间的超平面是平面，由此可推，四维空间的分割超平面肯定是一个三维空间。人类的大脑只能理解三维空间，对于更高维度的空间，其实我们很难理解。
机器学习中非常机智地把线性不可分的问题映射到高维度空间，分割之后再映射回原空间。  
在高维度解决问题的思想被应用于深度学习和高斯核方法等，高斯核方法相当于映射到无穷维的希尔伯特空间，将线性不可分的问题转变为可分的问题，这篇文章不讲技术，就不详细展开了。  
是不是有同学想到了《三体》里的降维攻击。哈哈。非常神奇吧。
当我们遇到束手无策的问题，或许转换一下视角（空间映射），问题可能就变得清晰可解了。更高级的做法或许是站在一个更高维度的视角，那个时候问题本身或许都不能称为问题了。  
这也说明提升认知能力，训练多维度视角的重要性。

###总结  
总结一下机器学习中的人生智慧：
> 1. 概率视角（帮助我们更清晰分析问题，决策）
> 2. 模型视角（理解学习过程，帮助我们更好学习）
> 3. 集成方法（准确率大于随机猜测的解决方案就有价值了）
> 4. 高维度攻击（用多维度视角解决问题）

参考：
[数学之美番外篇：平凡而又神奇的贝叶斯方法](http://mindhacks.cn/2008/09/21/the-magical-bayesian-method/)  
http://mindhacks.cn/2008/09/21/the-magical-bayesian-method/  
[贝叶斯推断及其互联网应用（一）：定理简介](http://www.ruanyifeng.com/blog/2011/08/bayesian_inference_part_one.html)  
http://www.ruanyifeng.com/blog/2011/08/bayesian_inference_part_one.html  
